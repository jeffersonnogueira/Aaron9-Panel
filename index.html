<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>AARON 9 - Painel em Tempo Real</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --bg-elevated: #020617;
      --card: #020617;
      --card-border: #1f293b;
      --accent: #22d3ee;
      --accent-soft: rgba(34, 211, 238, 0.12);
      --danger: #f97373;
      --success: #4ade80;
      --text-soft: #9ca3af;
      --text-main: #e5e7eb;
      --shadow-strong: 0 24px 60px rgba(15, 23, 42, 0.95);
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #0f172a 0, #020617 45%, #000 100%);
      color: var(--text-main);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    .app-shell {
      flex: 1;
      max-width: 1680px;
      margin: 18px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* TOP BAR */
    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 18px;
      border-radius: var(--radius-lg);
      border: 1px solid #1f2937;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 0.7));
      box-shadow: 0 22px 50px rgba(0, 0, 0, 0.85);
    }

    .brand-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .brand-title {
      font-size: 18px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    .brand-main {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--accent);
    }

    .status-pill {
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(34, 211, 238, 0.07);
      border: 1px solid rgba(34, 211, 238, 0.4);
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--success);
      box-shadow: 0 0 10px rgba(74, 222, 128, 0.8);
    }

    .timestamp {
      font-size: 12px;
      color: var(--text-soft);
    }

    /* LAYOUT 2 COLUNAS */
    .layout {
      flex: 1;
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.2fr);
      gap: 12px;
      align-items: stretch;
    }

    .card {
      border-radius: var(--radius-lg);
      border: 1px solid var(--card-border);
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.85), #020617 55%, #020617 100%);
      box-shadow: var(--shadow-strong);
      padding: 12px 14px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(34, 211, 238, 0.12), transparent 55%);
      opacity: 0.7;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
      height: 100%;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .card-title {
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      color: #9ca3af;
    }

    .badge {
      border-radius: 999px;
      padding: 3px 8px;
      font-size: 11px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
    }

    /* COLUNA ESQUERDA: TRADINGVIEW SLOT */
    .chart-placeholder {
      flex: 1;
      border-radius: 14px;
      border: 1px dashed rgba(148, 163, 184, 0.5);
      background: radial-gradient(circle at bottom, rgba(15, 23, 42, 0.7), rgba(15, 23, 42, 0.3));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: var(--text-soft);
      text-align: center;
      padding: 12px;
    }

    /* COLUNA DIREITA: PAINEL AARON 9 */
    .panel-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .panel-block {
      border-radius: 12px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      background: rgba(15, 23, 42, 0.85);
      padding: 8px 10px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      position: relative;
      overflow: hidden;
    }

    .panel-block::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.3), rgba(15, 23, 42, 0.0));
      opacity: 0.9;
      pointer-events: none;
    }

    .panel-block-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-soft);
    }

    .value-main {
      font-size: 13px;
      font-weight: 600;
    }

    .value-sub {
      font-size: 11px;
      color: var(--text-soft);
    }

    .row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      font-size: 11px;
    }

    .pill {
      border-radius: 999px;
      padding: 2px 7px;
      font-size: 10px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: #e5e7eb;
      background: rgba(15, 23, 42, 0.9);
    }

    .pill-green {
      border-color: rgba(74, 222, 128, 0.7);
      color: var(--success);
    }

    .pill-red {
      border-color: rgba(248, 113, 113, 0.7);
      color: var(--danger);
    }

    /* TERMÔMETROS (BARRAS) */
    .meter {
      position: relative;
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      overflow: hidden;
      border: 1px solid rgba(31, 41, 55, 0.9);
    }

    .meter-fill {
      position: absolute;
      inset: 0;
      transform-origin: left center;
      transform: scaleX(0.5);
      background: linear-gradient(90deg, #22d3ee, #4ade80);
    }

    .meter-fill-red {
      background: linear-gradient(90deg, #f97373, #fb923c);
    }

    /* BLOCO CONCLUSÃO TEXTO GRANDE */
    .conclusion-block {
      border-radius: 12px;
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.95));
      padding: 9px 10px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 6px;
      font-size: 12px;
    }

    .conclusion-title {
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--text-soft);
    }

    .conclusion-text {
      line-height: 1.4;
    }

    /* TIMESTAMP DO PAINEL */
    .panel-footer {
      margin-top: auto;
      font-size: 10px;
      color: var(--text-soft);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      opacity: 0.85;
    }

    @media (max-width: 1024px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <!-- TOPO -->
    <header class="top-bar">
      <div class="brand-block">
        <div class="brand-title">The SixSeats Investments</div>
        <div class="brand-main">AARON 9 – AI ULTRA</div>
      </div>
      <div style="display:flex; flex-direction:column; gap:4px; align-items:flex-end;">
        <div class="status-pill">
          <span class="status-dot"></span>
          <span id="status-text">Online – aguardando dados…</span>
        </div>
        <span class="timestamp" id="header-timestamp">Sem dados ainda</span>
      </div>
    </header>

    <!-- LAYOUT 2 COLUNAS -->
    <main class="layout">
      <!-- ESQUERDA: SLOT DO TRADINGVIEW -->
      <section class="card">
        <div class="card-inner">
          <div class="card-header">
            <div class="card-title">Janela do Gráfico</div>
            <span class="badge">TradingView aqui depois</span>
          </div>
          <div class="chart-placeholder" id="tv-slot">
            Aqui vai o widget do TradingView<br />
            (pode ser embed oficial quando você quiser).
          </div>
        </div>
      </section>

      <!-- DIREITA: PAINEL AARON 9 -->
      <section class="card">
        <div class="card-inner" id="panel-root">
          <div class="card-header">
            <div class="card-title">Painel AARON 9</div>
            <span class="badge" id="symbol-badge">Sem ativo</span>
          </div>

          <!-- GRID PRINCIPAL DE BLOCOS -->
          <div class="panel-grid">
            <!-- BLOCO STATUS / CONTEXTO -->
            <div class="panel-block">
              <div class="panel-block-title">Contexto</div>
              <div class="value-main" id="context-main">—</div>
              <div class="value-sub" id="context-sub">Esperando primeiro webhook…</div>
              <div class="row">
                <span>Direção atual:</span>
                <span class="pill" id="trend-pill">—</span>
              </div>
              <div class="row">
                <span>Qualidade do setup:</span>
                <span class="pill" id="edge-pill">—</span>
              </div>
            </div>

            <!-- BLOCO RISCO / POSIÇÃO -->
            <div class="panel-block">
              <div class="panel-block-title">Gestão de Risco</div>
              <div class="value-main">
                Risco: <span id="risk-ratio">—</span>
              </div>
              <div class="value-sub">
                Tamanho da posição: <span id="position-size">—</span>
              </div>
              <div class="row">
                <span>Stop ATR:</span>
                <span class="pill" id="atr-stop-pill">—</span>
              </div>
              <div class="row">
                <span>Modo:</span>
                <span class="pill" id="mode-pill">—</span>
              </div>
            </div>

            <!-- BLOCO FLOW A FAVOR -->
            <div class="panel-block">
              <div class="panel-block-title">Fluxo a Favor</div>
              <div class="row">
                <span>Probabilidade a favor:</span>
                <span id="favor-pct" class="pill pill-green">—</span>
              </div>
              <div class="meter">
                <div class="meter-fill" id="favor-meter"></div>
              </div>
              <div class="value-sub" id="favor-text">
                Termômetro do AARON para os compradores.
              </div>
            </div>

            <!-- BLOCO FLOW CONTRA -->
            <div class="panel-block">
              <div class="panel-block-title">Fluxo Contra</div>
              <div class="row">
                <span>Probabilidade contra:</span>
                <span id="contra-pct" class="pill pill-red">—</span>
              </div>
              <div class="meter">
                <div class="meter-fill meter-fill-red" id="contra-meter"></div>
              </div>
              <div class="value-sub" id="contra-text">
                Pressão contrária / short / realização de lucro.
              </div>
            </div>
          </div>

          <!-- BLOCO DIREÇÃO PREVISTA GERAL -->
          <div class="panel-block" style="margin-top:6px;">
            <div class="panel-block-title">Direção Prevista (Visão Geral)</div>
            <div class="row">
              <span>Próximos candles (1–3):</span>
              <span class="pill" id="short-forecast-pill">—</span>
            </div>
            <div class="row">
              <span>Panorama do dia:</span>
              <span class="pill" id="day-forecast-pill">—</span>
            </div>
            <div class="value-sub" id="forecast-sub">
              AARON analisa micro + macro estrutura para sugerir a direção mais provável.
            </div>
          </div>

          <!-- CONCLUSÃO / FRASE DO AARON -->
          <div class="conclusion-block">
            <div class="conclusion-title">Conclusão do AARON</div>
            <div class="conclusion-text" id="conclusion-text">
              Aguardando primeiro alerta do TradingView para montar o cenário.
            </div>
          </div>

          <!-- FOOTER (TIMESTAMP, SYMBOL, TIMEFRAME) -->
          <div class="panel-footer">
            <span id="panel-symbol-tf">Ativo / Tempo gráfico: —</span>
            <span id="panel-timestamp">Sem timestamp</span>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // ============================
    // CONFIG - AJUSTE AQUI DEPOIS
    // ============================
    // Se você estiver usando GitHub + n8n para atualizar um panel.json:
    // coloque aqui a URL RAW do JSON:
    //
    //   ex: https://raw.githubusercontent.com/SEU-USUARIO/aaron9/main/panel.json
    //
    // ou, se o n8n já devolver JSON direto, coloque o webhook:
    //
    //   ex: https://jjjnogueira.app.n8n.cloud/webhook/aaron9-panel
    //
    const PANEL_URL = 'https://raw.githubusercontent.com/SEU-USUARIO/aaron9/main/panel.json'; // TROQUE ISSO

    // intervalo de refresh em ms (5 segundos, por exemplo)
    const REFRESH_MS = 5000;

    // ============================
    // HELPERS
    // ============================
    function safeNum(v, dec = 2) {
      if (typeof v !== 'number') return v ?? '—';
      return v.toFixed(dec);
    }

    function clamp01(x) {
      if (typeof x !== 'number' || isNaN(x)) return 0;
      return Math.min(1, Math.max(0, x));
    }

    function setMeter(el, pct) {
      if (!el) return;
      const v = clamp01(pct);
      el.style.transform = 'scaleX(' + v + ')';
    }

    function fmtTsUtah(ts) {
      if (ts === undefined || ts === null) return 'sem timestamp';
      if (typeof ts === 'string') {
        const n = Number(ts);
        if (!isNaN(n)) ts = n;
      }
      if (typeof ts === 'number') {
        try {
          return new Date(ts).toLocaleString('en-US', {
            timeZone: 'America/Denver'
          });
        } catch (e) {
          return String(ts);
        }
      }
      return String(ts);
    }

    // ============================
    // RENDERIZAÇÃO DO PAINEL
    // ============================
    function renderPanel(panel) {
      if (!panel || typeof panel !== 'object') return;

      // Aqui eu assumo alguns campos genéricos.
      // Se o teu JSON tiver outro formato, é só me mandar depois
      // que eu ajusto o mapping — o layout já está pronto.

      const status = panel.status || {};
      const risk = panel.risk || {};
      const flow = panel.flow || {};
      const forecast = panel.forecast || {};
      const conclusion = panel.conclusion || {};
      const meta = panel.meta || {};

      // TOPO
      document.getElementById('status-text').textContent =
        status.label || 'Online – painel atualizado';

      document.getElementById('header-timestamp').textContent =
        meta.serverNow ? 'Server: ' + meta.serverNow : 'Atualizado';

      // Símbolo / timeframe
      const symbolStr = (status.symbol || '—') + ' · ' + (status.timeframe || '—');
      document.getElementById('symbol-badge').textContent = symbolStr;
      document.getElementById('panel-symbol-tf').textContent = 'Ativo / Tempo gráfico: ' + symbolStr;

      // Timestamp do painel (em ms)
      document.getElementById('panel-timestamp').textContent =
        'Painel: ' + fmtTsUtah(panel.timestamp);

      // Contexto
      document.getElementById('context-main').textContent =
        status.contextMain || 'Contexto não definido';
      document.getElementById('context-sub').textContent =
        status.contextSub || '—';

      document.getElementById('trend-pill').textContent =
        status.trend || '—';
      document.getElementById('edge-pill').textContent =
        status.edge || '—';

      // Risco
      document.getElementById('risk-ratio').textContent =
        risk.rr ? risk.rr + 'R' : '—';

      document.getElementById('position-size').textContent =
        risk.positionSize || '—';

      document.getElementById('atr-stop-pill').textContent =
        risk.atrStop || '—';

      document.getElementById('mode-pill').textContent =
        risk.mode || '—';

      // Flow a favor / contra
      const favorPct = typeof flow.favorPct === 'number' ? flow.favorPct : null;
      const contraPct = typeof flow.contraPct === 'number' ? flow.contraPct : null;

      document.getElementById('favor-pct').textContent =
        favorPct != null ? favorPct.toFixed(0) + '%' : '—';

      document.getElementById('contra-pct').textContent =
        contraPct != null ? contraPct.toFixed(0) + '%' : '—';

      setMeter(document.getElementById('favor-meter'),
        favorPct != null ? favorPct / 100 : 0);
      setMeter(document.getElementById('contra-meter'),
        contraPct != null ? contraPct / 100 : 0);

      document.getElementById('favor-text').textContent =
        flow.favorText || 'Termômetro do fluxo comprador.';

      document.getElementById('contra-text').textContent =
        flow.contraText || 'Termômetro do fluxo vendedor / contra.';

      // Forecast
      document.getElementById('short-forecast-pill').textContent =
        forecast.short || '—';

      document.getElementById('day-forecast-pill').textContent =
        forecast.day || '—';

      document.getElementById('forecast-sub').textContent =
        forecast.extra || '—';

      // Conclusão final
      document.getElementById('conclusion-text').textContent =
        conclusion.text || 'Sem conclusão no momento.';
    }

    async function loadPanelOnce() {
      try {
        const res = await fetch(PANEL_URL, {
          cache: 'no-store'
        });
        if (!res.ok) {
          console.error('Erro ao buscar painel:', res.status, res.statusText);
          document.getElementById('status-text').textContent =
            'Erro ao buscar painel (' + res.status + ')';
          return;
        }

        const data = await res.json();
        renderPanel(data.panel || data);
      } catch (err) {
        console.error('Erro no fetch do painel:', err);
        document.getElementById('status-text').textContent =
          'Erro de conexão com o painel';
      }
    }

    function startAutoRefresh() {
      loadPanelOnce();
      setInterval(loadPanelOnce, REFRESH_MS);
    }

    // start
    startAutoRefresh();
  </script>
</body>
</html>
